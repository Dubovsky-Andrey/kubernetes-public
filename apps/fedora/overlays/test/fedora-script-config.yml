# fedora-script-config.yml
apiVersion: v1
kind: ConfigMap
metadata:
  name: fedora-script
data:
  start.sh: |
    #!/bin/bash
    echo "Hello from overlay start.sh"
    echo "Hello from overlay2 start.sh"
    dnf update -y
    dnf install -y dnf-plugins-core wget unzip openssh openssh-server openvpn
    dnf config-manager addrepo --from-repofile=https://rpm.releases.hashicorp.com/fedora/hashicorp.repo
    dnf -y install terraform
    wget https://github.com/kubernetes-sigs/kustomize/releases/download/kustomize%2Fv5.6.0/kustomize_v5.6.0_linux_arm64.tar.gz
    tar zxvf kustomize_v5.6.0_linux_arm64.tar.gz
    rm -rf kustomize_v5.6.0_linux_arm64.tar.gz 
    mv kustomize /usr/local/bin/
    curl -LO https://dl.k8s.io/release/v1.32.0/bin/linux/arm64/kubectl
    mv kubectl /usr/local/bin/
    chmod +x /usr/local/bin/kubectl
    curl -O 'https://awscli.amazonaws.com/awscli-exe-linux-aarch64.zip'
    unzip awscli-exe-linux-aarch64.zip
    ./aws/install
    rm -rf aws awscli-exe-linux-aarch64.zip
    #dnf install -y ansible
    dnf install -y helm
    ARGOCD_VERSION=v2.14.11
    curl -Lo argocd-linux-arm64 https://github.com/argoproj/argo-cd/releases/download/$ARGOCD_VERSION/argocd-linux-amd64
    chmod +x argocd-linux-amd64
    sudo mv argocd-linux-amd64 /usr/local/bin/argocd
    kustomize version
    terraform version
    kubectl version
    aws --version
    tail -f /dev/null
